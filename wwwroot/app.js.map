{"version":3,"sources":["../src/app.js"],"names":["console","log","process","env","PORT","port_number","app","server","http","createServer","use","bodyParser","json","express","static","path","join","__dirname","resolve","passport","initialize","corsOption","origin","methods","credentials","exposedHeaders","req","res","next","header","routes","global","appRoot","resp","fileName","sendFile","listen"],"mappings":";;AAAA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;AACAA,QAAQC,GAAR,wBAAiCC,QAAQC,GAAR,CAAYC,IAA7C;AACA,IAAIC,cAAcH,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAApB,IAA4B,IAA9C;AACA,IAAIE,MAAM,wBAAV;;AAEAA,IAAIC,MAAJ,GAAaC,eAAKC,YAAL,CAAkBH,GAAlB,CAAb;AACAA,IAAII,GAAJ,CAAQC,qBAAWC,IAAX,EAAR;AACAN,IAAII,GAAJ,CAAQG,kBAAQC,MAAR,CAAeC,eAAKC,IAAL,CAAUC,SAAV,CAAf,CAAR;AACAX,IAAII,GAAJ,CAAQG,kBAAQC,MAAR,CAAeC,eAAKG,OAAL,CAAaD,YAAY,WAAzB,CAAf,CAAR;;AAEAX,IAAII,GAAJ,CAAQS,mBAASC,UAAT,EAAR;AACA;;AAEA,IAAIC,aAAa;AACbC,YAAQ,IADK;AAEbC,aAAS,gCAFI;AAGbC,iBAAa,IAHA;AAIbC,oBAAgB,CAAC,cAAD;AAJH,CAAjB;AAMAnB,IAAII,GAAJ,CAAQ,oBAAKW,UAAL,CAAR;;AAEAf,IAAII,GAAJ,CAAQ,UAASgB,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC7BD,QAAIE,MAAJ,CAAW,6BAAX,EAA0C,GAA1C;AACAF,QAAIE,MAAJ,CAAW,8BAAX,EAA2C,gDAA3C;AACAF,QAAIE,MAAJ,CAAW,8BAAX,EAA2C,iCAA3C;;AAEAD;AACH,CAND;;AASA;;AAEAtB,IAAII,GAAJ,CAAQ,MAAR,EAAgBoB,gBAAhB;;AAEAC,OAAOC,OAAP,GAAiBjB,eAAKG,OAAL,CAAaD,SAAb,CAAjB;AACAjB,QAAQC,GAAR,CAAY,gBAAZ,EAA8B8B,OAAOC,OAArC;;AAEA1B,IAAII,GAAJ,CAAQ,OAAR,EAAiB,UAACgB,GAAD,EAAMO,IAAN,EAAe;AAC5B;AACA,QAAIC,WAAWnB,eAAKG,OAAL,CAAaD,YAAY,qBAAzB,CAAf;AACAjB,YAAQC,GAAR,CAAY,cAAZ,EAA4BiC,QAA5B;AACAD,SAAKE,QAAL,CAAcD,QAAd;AACH,CALD;;AAOA;AACA;AACA;AACA;AACA;;AAEA5B,IAAII,GAAJ,CAAQ,IAAR,EAAc,UAACgB,GAAD,EAAMO,IAAN,EAAe;AACzB,QAAIC,WAAWnB,eAAKG,OAAL,CAAaD,YAAY,aAAzB,CAAf;AACAjB,YAAQC,GAAR,CAAY,eAAZ,EAA6BiC,QAA7B;AACAD,SAAKE,QAAL,CAAcD,QAAd;AACH,CAJD;;AAMA5B,IAAII,GAAJ,CAAQ,cAAR,EAAwB,UAACgB,GAAD,EAAMO,IAAN,EAAe;AACnC,QAAIC,WAAWnB,eAAKG,OAAL,CAAaD,YAAY,aAAzB,CAAf;AACAgB,SAAKE,QAAL,CAAcD,QAAd;AACH,CAHD;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA5B,IAAI8B,MAAJ,CAAW/B,WAAX,EAAwB,YAAM;AAC1BL,YAAQC,GAAR,CAAY,iCAAiCI,WAA7C;AACH,CAFD","file":"app.js","sourcesContent":["import \"babel-core/register\";\r\nimport \"babel-polyfill\";\r\nimport express from 'express';\r\nimport http from 'http';\r\nimport routes from './routes';\r\nimport bodyParser from 'body-parser';\r\nimport path from 'path';\r\nimport cors from 'cors';\r\nimport p from './passport';\r\nimport passport from 'passport';\r\nimport { setConfig, createPrerequisitesDir } from \"./utils/general\";\r\n// import CronScheduler from './commons/CronSheduler';\r\nconsole.log(`process.env.PORT: ${process.env.PORT}`);\r\nlet port_number = process.env.PORT || 3001 || 8005;\r\nlet app = express();\r\n\r\napp.server = http.createServer(app);\r\napp.use(bodyParser.json());\r\napp.use(express.static(path.join(__dirname)));\r\napp.use(express.static(path.resolve(__dirname + '/landing/')));\r\n\r\napp.use(passport.initialize());\r\n// app.use(CronScheduler);\r\n\r\nvar corsOption = {\r\n    origin: true,\r\n    methods: 'GET,HEAD,PUT,PATCH,POST,DELETE',\r\n    credentials: true,\r\n    exposedHeaders: ['x-auth-token']\r\n};\r\napp.use(cors(corsOption));\r\n\r\napp.use(function(req, res, next) {\r\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\r\n    res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\r\n    res.header('Access-Control-Allow-Methods', 'PUT, POST, GET, DELETE, OPTIONS');\r\n\r\n    next();\r\n});\r\n\r\n\r\ncreatePrerequisitesDir();\r\n\r\napp.use('/api', routes);\r\n\r\nglobal.appRoot = path.resolve(__dirname);\r\nconsole.log('global.appRoot', global.appRoot);\r\n\r\napp.use('/home', (req, resp) => {\r\n    // let fileName = path.resolve(__dirname + '/index.html');\r\n    let fileName = path.resolve(__dirname + '/landing/index.html');\r\n    console.log('request in /', fileName);\r\n    resp.sendFile(fileName);\r\n});\r\n\r\n// app.use('/tests', (req, resp) => {\r\n//     let fileName = path.resolve(__dirname + '/index.html');\r\n//     console.log('request in /', fileName);\r\n//     resp.sendFile(fileName);\r\n// });\r\n\r\napp.use('/*', (req, resp) => {\r\n    let fileName = path.resolve(__dirname + '/index.html');\r\n    console.log('request in /*', fileName);\r\n    resp.sendFile(fileName);\r\n});\r\n\r\napp.use('/testLanding', (req, resp) => {\r\n    let fileName = path.resolve(__dirname + '/index.html');\r\n    resp.sendFile(fileName);\r\n})\r\n/* This is for preventing routes and sending forbidden message for unknown urls */\r\n// app.get('/home', function (req, res) {\r\n//     let fileName = path.resolve(__dirname + '/index.html');\r\n//     console.log(fileName);\r\n//     res.sendFile(fileName);\r\n// });\r\n/* This is for allowing refresh when using client side routing and redirecting accordingly */\r\n/*\r\napp.get('/*', function (req, res) {\r\n    let fileName = path.resolve(__dirname + '/index.html');\r\n    console.log(fileName);\r\n    res.sendFile(fileName);\r\n});\r\n*/\r\napp.listen(port_number, () => {\r\n    console.log('Tech Assess API runnning on ' + port_number);\r\n})"]}